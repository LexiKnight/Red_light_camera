---
title: "Exploring Red Light Camera Annual Charges in the City of Toronto Between the Years of 2012 and 2022."
subtitle: "Looking at Five Busy Intersections in Toronto"
author: 
  - Lexi Knight
thanks: "Code and data are available at: https://github.com/LexiKnight/Red_light_camera.git"
date: today
date-format: long
abstract: " A ticket for running a red light in Ontario cost $325. Using data from five different intersections in Toronto as my sample, I looked at the number of charges issued for running red lights over a ten year period. Despite the cost of the ticket, there is a general trend of an average increase in the number of charges. These findings suggest red light camera charges do not necessarily disincentivize drivers from running lights in busy intersections in the City of Toronto."
format: pdf
number-sections: true
# bibliography: references.bib
---

```{r}
#| message: false
#| echo: false

### Workspace setup ###

# Install packages
# install.packages("tidyverse")
# install.packages("janitor")
# install.packages("dplyr")
# install.packages("readxl")
# install.packages("ggplot2")
# install.packages("here")
# install.packages('gridExtra')

# Load packages
library(tidyverse)
library(janitor)
library(dplyr)
library(readxl)
library(ggplot2)
library(here)
library(kableExtra)

# Read in cleaned data
cleaned_red_light_data <- read.csv("outputs/data/cleaned_red_light_data.csv")

```

# Introduction
In this paper I looked at how the red light charges in the City of Toronto has changed throughout the years as well as the intersection that contains the most annual charges. These five intersections of interest were spread out; two of which are located a 1km radius of Lake Ontario whereas the other three are located within a ten km radius of York University. This was done to evaluate the different regions of the City and to get an idea about where there are more charges issued, downtown or on the outskirts of the city. 

#TODO: add paper notes on red light cameras and whether they are efficient in incentivizing drivers to not run red lights - a safety concern. 

The remainder of this paper is structured as follows: Section 2 discusses the data, Section 3 discusses the model, Section 4 presents the results and lastly Section 5 discusses my findings as well as areas of weaknesses and improvements. 
should cross-reference sections and sub-sections. 


# Data {#sec-data}
I retrieved the data from Open Data Tronto Portal through the library {cite opendatatoronto, Gelfand 2022}. The dataset {cite redlightcameraannualcharges} was used to analyze the intersections with red light cameras across the City of Toronto. After downloading the dataset, I proceeded to the cleaning and analyzing stage with open source staticaically programming language R {cite R, R core team 2022}, using function from tidyverse {cite tidyverse, wickham et al 2019}, dplyer {cite dypler wickham et al 2022}, ggplot2 {cite ggplot2 wickham 2016}, readxl {cite readxl}, janitor {cite janitor firke 2021} and usethis. 

#TODO: citations!



```{r}
#| echo: false 
# code not included in doc
#| warning: false 
# no warnings in the doc
#| message: false 
# no messages in the doc
#| label: Table 1: Total Number of Charges per Year Based on Location
  
### Stimulate data ###
table1 <- cleaned_red_light_data


# rename the columns 
colnames(table1) = c("Location", "2012", "2013", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021", "2022")

# add a column for the sum of charges called "Total_Charges  
table1$Total_Charges <- rowSums(sapply(table1[,2:12],function(x)as.numeric(as.character(x))))

# make table cuter
cutie <- kable(table1, format = 'latex', booktable = TRUE, caption = 'Table: ') %>% kable_styling(latex_options = 'scale_down')
cutie

# figures and tables to be cross-referenced in text ex. figure 1 shows, table 1 describes...
# for every graph and table, need to be accompanying text that describes their main aspects and adds additional detail. 
```

# Model, model set up, model justification
Here we breifly describe the Red Light Data model used to investigate two aspects of the charges. Firstly, it is to explore how the number of charges varies over the different intersections, particularly as two are located near Lake Ontario whereas the other three are up North by York University. Secondly, in looking at one intersection in depth, namely Steeles Ave and Carpender Rd, to explore how the number of charges given vary over a ten year strech, 2012 through 2022.

# specify the equations that describe the model used and explain their components w/ plain language and cross-references
# start section by writting out mode, explaining it and justifying it. can add backgroung info if needed. 
# after specifying the model with appropriate mathematical notation and cross-referencing it, the components of the model should then be defined and explained. convincing reader model well chosen and enhances credibility of the reader
# model variables should correspond to those that were discussed in the data section, clear link b/w the two sections. 
# close model section with discussion of assumptions underpinning the model. brief discussion of alternative models/variants. Clearly explain strengths and weaknesses.

# evidence of model validation and checking, model convergence and or diganostic issues ( some of which perhaps more appropraite in appendix)

# some papers do not include statistical model and instead replace section by "methodology" section - describe simulation conducted or contain more general details about the approach. 


# Results

# clearly communicate outcomes of the analysis and w/out too much focus on the discussion of implications. 
# section requires summary statistics, tables, graphs - each cross referenced  and test associated with them that details what is seen in each figure. 
# what results are rather than what results mean
# tables of graphs of coefficient estimates based on the modeling. discuss features of the estimates and differences b/w the models 
# amount of test = amount space table/graph take up

results
I find  the average charges for the five intersections in 2022 is ????? with a high of ???. Additionally in diving deeper into the annual charges for specific locations, there is an upward trend in the last five years for four out of five of the intersections.  


```{r}
#| echo: false 
# code not included in doc
#| warning: false 
# no warnings in the doc
#| message: false 
# no messages in the doc

# to print locations in the table use
# table1$Location

# Want to plot location on x axis and sum charges  on y axis
# creating meaningful axies names, x is intersection and y is Total Charges
bar1 <- table1[,c(1,13)]
ggplot(table1 = bar1$Location) + geom_col(aes(x= table1$Location, y = table1$Total_Charges)) +labs(title = "Graph 1: Location vs. Total Changes", y = "Total Charges", x = "Location") 

# Here, trying to make x axies either angled or perpendicular so as to be readable.

#bar1 = go.Figure(my_fig)
#bar1.update_xaxes)tickangle=45)
#bar1.show()

#+(theme(axis.text.x = element_text(angle = 45, vjust =1, hjust = 1))





```



# Discussion

# breif summary of what was done in the paper


# 2-3 subsections devoted to key things learned about the world from the paper. justify / detail the implications of the story being told in the paper. explain what we learn from the grpahs/tables

## First discussion point {#sec-first-point}

Note did not use data for the years 2007 through 2010 as I wanted ot look specifically at a ten year range. Additonally, the dataset downloaded from opendatatoronto had minimal data for ten consecutive years, limiting my options. Moreover, locations were roughly spread out into two regions, downtown 1km away from Lake Ontario and North about 9km away from York University. The reason for this was to get data on a larger area. 

## Second discussion point

## Third discussion point


## Weaknesses and next steps
I should note that the data only includes drivers that did get charged for running the light and thus there could be data missing for those drivers that did not get charged. 
Future work could look at for example intersections specifally around the university of toronto as this would implicate safety for these students. However, more and consistent data is needed as mentioned above for particular intersections and to be able to accurately compare data over several years. 
Future work could look at several intersections that are closer together, in a more confined area to allow for more understanding of which intersections drivers are more likely to run red lights. 
# data used, approach, model
# model - aspects that would affect the findings
# what there is left to learn and how future work could proceed. 
# discussion is 25% of the entire paper


\newpage

\appendix

# Appendix {-}
# This is where show all the data
# This is where include background details and diagnostics


\newpage


# References


